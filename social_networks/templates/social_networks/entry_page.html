{% extends 'social_networks/base.html' %}
{% load static %}
<!DOCTYPE html>
<html>
    <head>
      {% block head %}
      <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">
      {% endblock head %}
    </head>
    <body>
        <header>
        </header>
        <main>
            {% block content %}

                <a href="{% url 'social_networks:entries' topic_id %}">Назад</a> - 
                <a href="{% url 'social_networks:edit_entry' entry.id %}">Edit entry</a> - 
                <a href="{% url 'social_networks:delete_entry' entry.id %}">Delete entry</a>
                
                <div>
                  <h2>{{ entry.title }}</h2>
                  <p>{{ entry.text }}</p>
                </div>  
                <div>
                  <ul>
                    {% for comment_lvl_1 in comments %}
                      <li>
                        <div class="main-comment">
                          <p>{{ comment_lvl_1.comment_text }}</p>
                          <form action="{% url 'social_networks:delete_comment' entry.id comment_lvl_1.id %}">
                              <button name="submit">delet</button>
                          </form>
                        </div>

                        <ol>
                          {% for comment_lvl_2 in comment_lvl_1.answers %}
                            <li>
                              <div class="answer-on-comment">
                                <p>{{ comment_lvl_2.comment_text }}</p>

                                <form name="delete_comment_answer" action="{% url 'social_networks:delete_comment_answer' entry.id comment_lvl_1.id comment_lvl_2.id %}" method="post">
                                  {% csrf_token %}
                                  <button name="submit">delete</button>
                                </form>
                              </div>

                                {# comments #}
                                {% for comment_lvl_3 in comment_lvl_2.answers %}
                                  <ul>
                                    <li>
                                        <p>{{ comment_lvl_3.comment_text }}</p>
                                        <form name="delete_comment_lvl_3" action="{% url 'social_networks:delete_comment_answer' entry.id comment_lvl_1.id comment_lvl_3.id %}" method="post">
                                          {% csrf_token %}
                                          <button name="submit">delete</button>
                                        </form>
                                    </li>
                                    
                                  </ul>

                                {% endfor %}



                                {# answer #}
                                <div>
                                  <form name="answer_comment_form_lvl_2" action="{% url 'social_networks:answer_on_comment_lvl_2' entry.id comment_lvl_1.id comment_lvl_2.id %}" method="POST">
                                    {% csrf_token %}
                                    {{ answer_comment_form.as_p }}
                                    <button name="submit">Answer</button>
                                  </form>
                                </div>

                            </li>
                          {% endfor %}
                        </ol>

                        <div>
                          <form name="answer_comment_form" action="{% url 'social_networks:answer_on_comment_lvl_1' entry.id comment_lvl_1.id %}" method="POST">
                            {% csrf_token %}
                            {{ answer_comment_form.as_p }}
                            <button name="submit">Answer</button>
                          </form>
                        </div>
                      </li>
                    {% endfor %}
                  </ul>
                </div>

                {# Add comment lvl_1 #}
                <div>
                  <form name="comment_form" action="{% url 'social_networks:entry_page' topic_id entry.id %}" method="POST">
                    {% csrf_token %}
                    {{ comment_form.as_p }}
                    <button name="submit">Send</button>
                  </form>
                </div>


            {% endblock content %}
        </main>
        <footer>
            
        </footer>
    </body>
</html>